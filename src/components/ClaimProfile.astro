---
/**
 * MDRPedia â€” Premium Claim Profile Portal
 * Embedded into doctor profiles
 */
interface Props {
    doctorName: string;
    slug: string;
}

const { doctorName, slug } = Astro.props;
---

<section class="claim-profile-premium" id="claim-profile">
    <div class="claim-card">
        <div class="claim-bg">
            <div class="glow glow-1"></div>
            <div class="glow glow-2"></div>
        </div>

        <div class="claim-content">
            <div class="claim-header">
                <div class="icon-wrapper">
                    <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                        ></path>
                        <path d="M9 12l2 2 4-4"></path>
                    </svg>
                </div>
                <h3>Are you {doctorName}?</h3>
                <p>
                    Claim your MDRPedia profile to unlock analytics, manage your
                    digital legacy, and receive your verified badge.
                </p>
            </div>

            <form class="claim-form" id="claimForm" data-slug={slug}>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="claimEmail">Institutional Email</label>
                        <div class="input-wrapper">
                            <svg
                                class="input-icon"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                                ></path>
                                <polyline points="22,6 12,13 2,6"></polyline>
                            </svg>
                            <input
                                type="email"
                                id="claimEmail"
                                placeholder="dr.name@hospital.edu"
                                required
                            />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="claimLicense"
                            >Medical License / NPI Number</label
                        >
                        <div class="input-wrapper">
                            <svg
                                class="input-icon"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <rect
                                    x="3"
                                    y="11"
                                    width="18"
                                    height="11"
                                    rx="2"
                                    ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0110 0v4"></path>
                            </svg>
                            <input
                                type="text"
                                id="claimLicense"
                                placeholder="National Provider Identifier"
                                required
                            />
                        </div>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label>Verification Document</label>
                    <div class="upload-zone" id="uploadArea">
                        <div class="upload-icon">
                            <svg
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"
                                ></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                        </div>
                        <div class="upload-text">
                            <strong>Click to upload</strong> or drag and drop
                            <span>PDF, JPG or PNG (max. 10MB)</span>
                        </div>
                    </div>
                    <input
                        type="file"
                        id="certUpload"
                        accept=".pdf,.jpg,.jpeg,.png"
                        class="sr-only"
                    />
                </div>

                <div style="display:none; opacity:0; visibility:hidden;">
                    <input
                        type="text"
                        id="website_url_hp"
                        name="website_url_hp"
                        tabindex="-1"
                        autocomplete="off"
                    />
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <span>Submit Verification Request</span>
                    <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                        <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                </button>
            </form>

            <div class="trust-footer">
                <div class="trust-badge">
                    <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                        ></path>
                    </svg>
                    256-bit Secure
                </div>
                <div class="trust-badge">
                    <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Fast Review (48h)
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .claim-profile-premium {
        margin: 4rem auto;
        max-width: 800px;
        position: relative;
    }

    .claim-card {
        background: linear-gradient(
            145deg,
            rgba(30, 30, 45, 0.95),
            rgba(20, 20, 35, 0.98)
        );
        border: 1px solid rgba(139, 92, 246, 0.3);
        border-radius: 24px;
        overflow: hidden;
        position: relative;
        box-shadow:
            0 25px 50px -12px rgba(0, 0, 0, 0.5),
            0 0 0 1px rgba(139, 92, 246, 0.1),
            0 0 80px -20px rgba(139, 92, 246, 0.2);
        backdrop-filter: blur(20px);
    }

    .claim-bg {
        position: absolute;
        inset: 0;
        pointer-events: none;
        overflow: hidden;
    }

    .glow {
        position: absolute;
        width: 300px;
        height: 300px;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0.15;
    }

    .glow-1 {
        background: #8b5cf6;
        top: -100px;
        left: -100px;
        animation: pulse 8s ease-in-out infinite alternate;
    }

    .glow-2 {
        background: #ec4899;
        bottom: -100px;
        right: -100px;
        animation: pulse 8s ease-in-out infinite alternate-reverse;
    }

    @keyframes pulse {
        0% {
            transform: scale(1);
            opacity: 0.15;
        }
        100% {
            transform: scale(1.2);
            opacity: 0.25;
        }
    }

    .claim-content {
        position: relative;
        z-index: 1;
        padding: 3rem;
    }

    .claim-header {
        text-align: center;
        margin-bottom: 2.5rem;
    }

    .icon-wrapper {
        width: 64px;
        height: 64px;
        background: linear-gradient(
            135deg,
            rgba(139, 92, 246, 0.2),
            rgba(236, 72, 153, 0.1)
        );
        border: 1px solid rgba(139, 92, 246, 0.3);
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
    }

    .icon-wrapper svg {
        width: 32px;
        height: 32px;
        color: #a855f7;
    }

    .claim-header h3 {
        font-size: 2rem;
        font-weight: 800;
        color: white;
        margin-bottom: 0.75rem;
        background: linear-gradient(135deg, white, #a855f7);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .claim-header p {
        color: #9ca3af;
        font-size: 1.05rem;
        line-height: 1.6;
        max-width: 500px;
        margin: 0 auto;
    }

    .claim-form {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
    }

    @media (max-width: 640px) {
        .form-grid {
            grid-template-columns: 1fr;
        }
        .claim-content {
            padding: 2rem 1.5rem;
        }
    }

    .form-group label {
        display: block;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #d1d5db;
        margin-bottom: 0.5rem;
    }

    .input-wrapper {
        position: relative;
    }

    .input-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        width: 18px;
        height: 18px;
        color: #6b7280;
        transition: color 0.3s;
    }

    .input-wrapper input {
        width: 100%;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(139, 92, 246, 0.2);
        border-radius: 12px;
        padding: 1rem 1rem 1rem 3rem;
        color: white;
        font-size: 1rem;
        transition: all 0.3s;
    }

    .input-wrapper input:focus {
        outline: none;
        border-color: #a855f7;
        background: rgba(0, 0, 0, 0.5);
        box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.15);
    }

    .input-wrapper input:focus + .input-icon {
        color: #a855f7;
    }

    .upload-zone {
        border: 2px dashed rgba(139, 92, 246, 0.3);
        border-radius: 16px;
        padding: 2.5rem 1.5rem;
        text-align: center;
        background: rgba(255, 255, 255, 0.02);
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }

    .upload-zone:hover,
    .upload-zone.dragover {
        border-color: #a855f7;
        background: rgba(139, 92, 246, 0.05);
        transform: translateY(-2px);
    }

    .upload-icon {
        width: 48px;
        height: 48px;
        background: rgba(168, 85, 247, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #a855f7;
    }

    .upload-icon svg {
        width: 24px;
        height: 24px;
    }

    .upload-text {
        color: #d1d5db;
        font-size: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .upload-text span {
        font-size: 0.8rem;
        color: #6b7280;
    }

    .upload-text strong {
        color: #a855f7;
    }

    .submit-btn {
        background: linear-gradient(135deg, #a855f7, #7c3aed);
        color: white;
        border: none;
        padding: 1.25rem;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        transition: all 0.3s;
        box-shadow: 0 10px 20px -10px rgba(139, 92, 246, 0.5);
        margin-top: 1rem;
    }

    .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 30px -10px rgba(139, 92, 246, 0.6);
    }

    .submit-btn svg {
        width: 20px;
        height: 20px;
        transition: transform 0.3s;
    }

    .submit-btn:hover svg {
        transform: translateX(4px);
    }

    .submit-btn.success {
        background: linear-gradient(135deg, #10b981, #059669);
        pointer-events: none;
        box-shadow: 0 10px 20px -10px rgba(16, 185, 129, 0.5);
    }

    .trust-footer {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .trust-badge {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
        font-weight: 500;
        color: #9ca3af;
    }

    .trust-badge svg {
        width: 16px;
        height: 16px;
        color: #10b981;
    }

    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border: 0;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const uploadArea = document.getElementById("uploadArea");
        const fileInput = document.getElementById(
            "certUpload",
        ) as HTMLInputElement;

        uploadArea?.addEventListener("click", () => fileInput?.click());

        // Drag & drop
        uploadArea?.addEventListener("dragover", (e) => {
            e.preventDefault();
            uploadArea.classList.add("dragover");
        });

        uploadArea?.addEventListener("dragleave", () => {
            uploadArea.classList.remove("dragover");
        });

        uploadArea?.addEventListener("drop", (e) => {
            e.preventDefault();
            uploadArea.classList.remove("dragover");
            const files = (e as DragEvent).dataTransfer?.files;
            if (files && files.length > 0 && fileInput) {
                const dt = new DataTransfer();
                dt.items.add(files[0]);
                fileInput.files = dt.files;
                const text = uploadArea.querySelector(".upload-text");
                if (text)
                    text.innerHTML = `<strong>Selected:</strong><br/><span>${files[0].name}</span>`;
            }
        });

        fileInput?.addEventListener("change", () => {
            if (fileInput.files && fileInput.files.length > 0) {
                const text = uploadArea?.querySelector(".upload-text");
                if (text)
                    text.innerHTML = `<strong>Selected:</strong><br/><span>${fileInput.files[0].name}</span>`;
            }
        });

        // Form submit
        const form = document.getElementById("claimForm");
        form?.addEventListener("submit", (e) => {
            e.preventDefault();
            const btn = document.getElementById("submitBtn");
            if (btn) {
                const hp = document.getElementById(
                    "website_url_hp",
                ) as HTMLInputElement;
                if (hp && hp.value) {
                    console.warn("Bot detected");
                    return;
                }

                btn.classList.add("success");
                btn.innerHTML = `
                    <span>Request Submitted Successfully</span>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"/>
                    </svg>
                `;
            }
        });
    });
</script>
